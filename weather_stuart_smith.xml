<?xml version="1.0" encoding="UTF-8"?>
<exp:Export Version="3.0"
    xmlns:L7p="http://www.layer7tech.com/ws/policy"
    xmlns:exp="http://www.layer7tech.com/ws/policy/export" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy">
    <exp:References>
        <EncapsulatedAssertionReference RefType="com.l7tech.console.policy.exporter.EncapsulatedAssertionReference">
            <Name>InitialiseAuditLog</Name>
            <Guid>2a6c73f6-1173-473d-a133-1945518b4098</Guid>
        </EncapsulatedAssertionReference>
        <IncludedPolicyReference
            RefType="com.l7tech.console.policy.exporter.IncludedPolicyReference"
            guid="cf3b216f-94de-49a5-8e38-7043b39d9faa" included="true"
            name="checkApikey" soap="false" type="INCLUDE_FRAGMENT">
            <wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy">
                <wsp:All wsp:Usage="Required">
                    <wsp:OneOrMore wsp:Usage="Required">
                        <wsp:All wsp:Usage="Required">
                            <L7p:ComparisonAssertion>
                                <L7p:Expression1 stringValue="${request.http.parameter.apiKey}"/>
                                <L7p:Expression2 stringValue="${gateway.locationAndWeather.apikey}"/>
                                <L7p:Predicates predicates="included">
                                    <L7p:item binary="included">
                                    <L7p:RightValue stringValue="${gateway.locationAndWeather.apikey}"/>
                                    </L7p:item>
                                </L7p:Predicates>
                            </L7p:ComparisonAssertion>
                            <L7p:assertionComment>
                                <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="LEFT.COMMENT"/>
                                    <L7p:value stringValue="&lt;VALID>"/>
                                    </L7p:entry>
                                </L7p:Properties>
                            </L7p:assertionComment>
                        </wsp:All>
                        <wsp:All wsp:Usage="Required">
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue="QVBJIEtleSBJbnZhbGlk"/>
                                <L7p:VariableToSet stringValue="error"/>
                            </L7p:SetVariable>
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue="NDAx"/>
                                <L7p:VariableToSet stringValue="errorHttpStatusCode"/>
                            </L7p:SetVariable>
                            <L7p:Encapsulated>
                                <L7p:EncapsulatedAssertionConfigGuid stringValue="2e6fb6b6-53b8-4aa9-b576-d591cfca143c"/>
                                <L7p:EncapsulatedAssertionConfigName stringValue="createAuditLogEntry"/>
                                <L7p:Parameters mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="Log.dev"/>
                                    <L7p:value stringValue="apikey invalid. apikey = ${request.http.parameter.apiKey}"/>
                                    </L7p:entry>
                                    <L7p:entry>
                                    <L7p:key stringValue="Log.prod"/>
                                    <L7p:value stringValue="apikey invalid. apikey = ${request.http.parameter.apiKey}"/>
                                    </L7p:entry>
                                </L7p:Parameters>
                            </L7p:Encapsulated>
                            <L7p:FalseAssertion/>
                            <L7p:assertionComment>
                                <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="LEFT.COMMENT"/>
                                    <L7p:value stringValue="&lt;INVALID>"/>
                                    </L7p:entry>
                                </L7p:Properties>
                            </L7p:assertionComment>
                        </wsp:All>
                        <L7p:assertionComment>
                            <L7p:Properties mapValue="included">
                                <L7p:entry>
                                    <L7p:key stringValue="LEFT.COMMENT"/>
                                    <L7p:value stringValue="&lt;CHECK API KEY>"/>
                                </L7p:entry>
                            </L7p:Properties>
                        </L7p:assertionComment>
                    </wsp:OneOrMore>
                </wsp:All>
            </wsp:Policy>
        </IncludedPolicyReference>
        <EncapsulatedAssertionReference RefType="com.l7tech.console.policy.exporter.EncapsulatedAssertionReference">
            <Name>createAuditLogEntry</Name>
            <Guid>2e6fb6b6-53b8-4aa9-b576-d591cfca143c</Guid>
        </EncapsulatedAssertionReference>
        <IncludedPolicyReference
            RefType="com.l7tech.console.policy.exporter.IncludedPolicyReference"
            guid="c7b5af2e-6418-4d17-8b8c-62a04f6f9ce3" included="true"
            name="basicAuth" soap="false" type="INCLUDE_FRAGMENT">
            <wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy">
                <wsp:All wsp:Usage="Required">
                    <L7p:AuditDetailAssertion>
                        <L7p:Detail stringValue="Policy Fragment: basicAuth"/>
                    </L7p:AuditDetailAssertion>
                    <L7p:HttpBasic/>
                    <wsp:OneOrMore wsp:Usage="Required">
                        <L7p:Authentication>
                            <L7p:IdentityProviderOid goidValue="0000000000000000fffffffffffffffe"/>
                        </L7p:Authentication>
                        <wsp:All wsp:Usage="Required">
                            <L7p:Encapsulated>
                                <L7p:EncapsulatedAssertionConfigGuid stringValue="2e6fb6b6-53b8-4aa9-b576-d591cfca143c"/>
                                <L7p:EncapsulatedAssertionConfigName stringValue="createAuditLogEntry"/>
                                <L7p:Parameters mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="Log.dev"/>
                                    <L7p:value stringValue="Authentication failed for user"/>
                                    </L7p:entry>
                                    <L7p:entry>
                                    <L7p:key stringValue="Log.prod"/>
                                    <L7p:value stringValue="Authentication failed for user"/>
                                    </L7p:entry>
                                </L7p:Parameters>
                            </L7p:Encapsulated>
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue="NDAx"/>
                                <L7p:VariableToSet stringValue="errorHttpStatusCode"/>
                            </L7p:SetVariable>
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue="QWNjZXNzIERlbmllZA=="/>
                                <L7p:VariableToSet stringValue="error"/>
                            </L7p:SetVariable>
                            <L7p:FalseAssertion/>
                        </wsp:All>
                    </wsp:OneOrMore>
                </wsp:All>
            </wsp:Policy>
        </IncludedPolicyReference>
        <IDProviderReference RefType="com.l7tech.console.policy.exporter.IdProviderReference">
            <GOID>0000000000000000fffffffffffffffe</GOID>
            <Name>Internal Identity Provider</Name>
            <Props>PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPGphdmEgdmVyc2lvbj0iMS44&#xd;
LjBfMTAyIiBjbGFzcz0iamF2YS5iZWFucy5YTUxEZWNvZGVyIj4KIDxvYmplY3QgY2xhc3M9Imph&#xd;
dmEudXRpbC5IYXNoTWFwIj4KICA8dm9pZCBtZXRob2Q9InB1dCI+CiAgIDxzdHJpbmc+YWRtaW5F&#xd;
bmFibGVkPC9zdHJpbmc+CiAgIDxib29sZWFuPnRydWU8L2Jvb2xlYW4+CiAgPC92b2lkPgogPC9v&#xd;
YmplY3Q+CjwvamF2YT4K</Props>
            <TypeVal>1</TypeVal>
        </IDProviderReference>
    </exp:References>
    <wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy">
        <wsp:All wsp:Usage="Required">
            <L7p:CommentAssertion>
                <L7p:Comment stringValue="18.01.17 S.Smith"/>
            </L7p:CommentAssertion>
            <L7p:CommentAssertion>
                <L7p:Comment stringValue=" "/>
            </L7p:CommentAssertion>
            <L7p:CommentAssertion>
                <L7p:Comment stringValue=" Takes two optional parameters"/>
            </L7p:CommentAssertion>
            <L7p:CommentAssertion>
                <L7p:Comment stringValue=" ip = Ip address. If not specified API will use GW server public IP address"/>
            </L7p:CommentAssertion>
            <L7p:CommentAssertion>
                <L7p:Comment stringValue=" coords = coordinates on lat, long format. e.g. &quot;51.5, -013&quot;"/>
            </L7p:CommentAssertion>
            <L7p:CommentAssertion>
                <L7p:Comment stringValue=" If both coords AND IP are specified, only ip will be used"/>
            </L7p:CommentAssertion>
            <L7p:CommentAssertion>
                <L7p:Comment stringValue=" "/>
            </L7p:CommentAssertion>
            <L7p:CommentAssertion>
                <L7p:Comment stringValue="output format of JSON and XML supported. Client should set "/>
            </L7p:CommentAssertion>
            <L7p:CommentAssertion>
                <L7p:Comment stringValue=" accept-encoding to either application/json or application/xml"/>
            </L7p:CommentAssertion>
            <L7p:CommentAssertion>
                <L7p:Comment stringValue=" EXAMPLE call:"/>
            </L7p:CommentAssertion>
            <L7p:CommentAssertion>
                <L7p:Comment stringValue=" https://gateway1:8443/locationAndWeather?ip=10.5.4.2"/>
            </L7p:CommentAssertion>
            <L7p:CommentAssertion>
                <L7p:Comment stringValue=" https://gateway1:8443/locationAndWeather?coords=51.5,-013"/>
            </L7p:CommentAssertion>
            <L7p:CommentAssertion>
                <L7p:Comment stringValue=" specify format=short or long  for short of full response"/>
            </L7p:CommentAssertion>
            <L7p:CommentAssertion>
                <L7p:Comment stringValue=" "/>
            </L7p:CommentAssertion>
            <L7p:Encapsulated>
                <L7p:EncapsulatedAssertionConfigGuid stringValue="2a6c73f6-1173-473d-a133-1945518b4098"/>
                <L7p:EncapsulatedAssertionConfigName stringValue="InitialiseAuditLog"/>
            </L7p:Encapsulated>
            <L7p:SetVariable>
                <L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAuaGVhZGVyLmFjY2VwdC1lbmNvZGluZ30="/>
                <L7p:VariableToSet stringValue="acceptEncoding"/>
            </L7p:SetVariable>
            <L7p:SetVariable>
                <L7p:Base64Expression stringValue="U3lzdGVtIEVycm9y"/>
                <L7p:VariableToSet stringValue="error"/>
            </L7p:SetVariable>
            <L7p:SetVariable>
                <L7p:Base64Expression stringValue="NTAw"/>
                <L7p:VariableToSet stringValue="errorHttpStatusCode"/>
            </L7p:SetVariable>
            <L7p:SslAssertion/>
            <wsp:OneOrMore wsp:Usage="Required">
                <wsp:All wsp:Usage="Required">
                    <L7p:ComparisonAssertion>
                        <L7p:CaseSensitive booleanValue="false"/>
                        <L7p:Expression1 stringValue="${request.http.header.accept-encoding}"/>
                        <L7p:MultivaluedComparison multivaluedComparison="ANY"/>
                        <L7p:Operator operatorNull="null"/>
                        <L7p:Predicates predicates="included">
                            <L7p:item dataType="included">
                                <L7p:Type variableDataType="string"/>
                            </L7p:item>
                            <L7p:item binary="included">
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:Operator operator="CONTAINS"/>
                                <L7p:RightValue stringValue="json"/>
                            </L7p:item>
                        </L7p:Predicates>
                    </L7p:ComparisonAssertion>
                    <L7p:CustomizeErrorResponse>
                        <L7p:Content stringValue="{&quot;error&quot;:${error}}"/>
                        <L7p:ContentType stringValue="application/json; charset=UTF-8"/>
                        <L7p:ExtraHeaders nameValuePairArray="included"/>
                        <L7p:HttpStatus stringValue="${errorHttpStatusCode}"/>
                    </L7p:CustomizeErrorResponse>
                    <L7p:assertionComment>
                        <L7p:Properties mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="LEFT.COMMENT"/>
                                <L7p:value stringValue="&lt;JSON>"/>
                            </L7p:entry>
                        </L7p:Properties>
                    </L7p:assertionComment>
                </wsp:All>
                <wsp:All wsp:Usage="Required">
                    <L7p:CustomizeErrorResponse>
                        <L7p:Content stringValue="&lt;error>${error}&lt;/error>"/>
                        <L7p:ContentType stringValue="application/xml; charset=UTF-8"/>
                        <L7p:ExtraHeaders nameValuePairArray="included"/>
                        <L7p:HttpStatus stringValue="${errorHttpStatusCode}"/>
                    </L7p:CustomizeErrorResponse>
                    <L7p:assertionComment>
                        <L7p:Properties mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="LEFT.COMMENT"/>
                                <L7p:value stringValue="&lt;XML FALLBACK>"/>
                            </L7p:entry>
                        </L7p:Properties>
                    </L7p:assertionComment>
                </wsp:All>
                <L7p:assertionComment>
                    <L7p:Properties mapValue="included">
                        <L7p:entry>
                            <L7p:key stringValue="LEFT.COMMENT"/>
                            <L7p:value stringValue="&lt;SETUP ERROR FORMAT>"/>
                        </L7p:entry>
                    </L7p:Properties>
                </L7p:assertionComment>
            </wsp:OneOrMore>
            <L7p:Include>
                <L7p:PolicyGuid stringValue="cf3b216f-94de-49a5-8e38-7043b39d9faa"/>
            </L7p:Include>
            <L7p:Include>
                <L7p:PolicyGuid stringValue="c7b5af2e-6418-4d17-8b8c-62a04f6f9ce3"/>
            </L7p:Include>
            <L7p:Encapsulated>
                <L7p:EncapsulatedAssertionConfigGuid stringValue="2e6fb6b6-53b8-4aa9-b576-d591cfca143c"/>
                <L7p:EncapsulatedAssertionConfigName stringValue="createAuditLogEntry"/>
                <L7p:Parameters mapValue="included">
                    <L7p:entry>
                        <L7p:key stringValue="Log.dev"/>
                        <L7p:value stringValue="Got accept Encoding of: ${acceptEncoding}"/>
                    </L7p:entry>
                    <L7p:entry>
                        <L7p:key stringValue="Log.prod"/>
                        <L7p:value stringValue=""/>
                    </L7p:entry>
                </L7p:Parameters>
            </L7p:Encapsulated>
            <wsp:OneOrMore wsp:Usage="Required">
                <wsp:All wsp:Usage="Required">
                    <L7p:RateLimit>
                        <L7p:CounterName stringValue="PRESET(259388a5f18c800c)${request.clientid}"/>
                        <L7p:HardLimit booleanValue="true"/>
                        <L7p:MaxRequestsPerSecond stringValue="1"/>
                        <L7p:SplitRateLimitAcrossNodes booleanValue="false"/>
                    </L7p:RateLimit>
                </wsp:All>
                <wsp:All wsp:Usage="Required">
                    <L7p:SetVariable>
                        <L7p:Base64Expression stringValue="QVBJIFJhdGUgRXhjZWVkZWQuIFRyeSBBZ2FpbiBMYXRlcg=="/>
                        <L7p:VariableToSet stringValue="error"/>
                    </L7p:SetVariable>
                    <L7p:Encapsulated>
                        <L7p:EncapsulatedAssertionConfigGuid stringValue="2e6fb6b6-53b8-4aa9-b576-d591cfca143c"/>
                        <L7p:EncapsulatedAssertionConfigName stringValue="createAuditLogEntry"/>
                        <L7p:Parameters mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="Log.dev"/>
                                <L7p:value stringValue="API Rate Exceeded"/>
                            </L7p:entry>
                            <L7p:entry>
                                <L7p:key stringValue="Log.prod"/>
                                <L7p:value stringValue="API Rate Exceeded"/>
                            </L7p:entry>
                        </L7p:Parameters>
                    </L7p:Encapsulated>
                    <L7p:FalseAssertion/>
                </wsp:All>
                <L7p:assertionComment>
                    <L7p:Properties mapValue="included">
                        <L7p:entry>
                            <L7p:key stringValue="LEFT.COMMENT"/>
                            <L7p:value stringValue="&lt;RATE>"/>
                        </L7p:entry>
                    </L7p:Properties>
                </L7p:assertionComment>
            </wsp:OneOrMore>
            <wsp:OneOrMore wsp:Usage="Required">
                <L7p:ThroughputQuota>
                    <L7p:CounterName stringValue="PRESET(e15790c024fce065)${request.tcp.remoteAddress}"/>
                    <L7p:Global booleanValue="true"/>
                    <L7p:Quota stringValue="5"/>
                    <L7p:Synchronous booleanValue="false"/>
                    <L7p:TimeUnit intValue="2"/>
                </L7p:ThroughputQuota>
                <wsp:All wsp:Usage="Required">
                    <L7p:SetVariable>
                        <L7p:Base64Expression stringValue="QVBJIFRocm91Z2hwdXQgUXVvdGEgRXhjZWVkZWQuIFRyeSBBZ2FpbiBMYXRlcg=="/>
                        <L7p:VariableToSet stringValue="error"/>
                    </L7p:SetVariable>
                    <L7p:Encapsulated>
                        <L7p:EncapsulatedAssertionConfigGuid stringValue="2e6fb6b6-53b8-4aa9-b576-d591cfca143c"/>
                        <L7p:EncapsulatedAssertionConfigName stringValue="createAuditLogEntry"/>
                        <L7p:Parameters mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="Log.dev"/>
                                <L7p:value stringValue="Throughput Quota Exceeded"/>
                            </L7p:entry>
                            <L7p:entry>
                                <L7p:key stringValue="Log.prod"/>
                                <L7p:value stringValue="Throughput Quota Exceeded"/>
                            </L7p:entry>
                        </L7p:Parameters>
                    </L7p:Encapsulated>
                    <L7p:FalseAssertion/>
                </wsp:All>
                <L7p:assertionComment>
                    <L7p:Properties mapValue="included">
                        <L7p:entry>
                            <L7p:key stringValue="LEFT.COMMENT"/>
                            <L7p:value stringValue="&lt;THROUGHPUT>"/>
                        </L7p:entry>
                    </L7p:Properties>
                </L7p:assertionComment>
            </wsp:OneOrMore>
            <L7p:SetVariable>
                <L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLmlwfQ=="/>
                <L7p:VariableToSet stringValue="ipAddress"/>
            </L7p:SetVariable>
            <L7p:SetVariable>
                <L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLmNvb3Jkc30="/>
                <L7p:VariableToSet stringValue="coordinates"/>
            </L7p:SetVariable>
            <L7p:SetVariable>
                <L7p:Base64Expression stringValue="TE9ORw=="/>
                <L7p:VariableToSet stringValue="format"/>
            </L7p:SetVariable>
            <wsp:OneOrMore wsp:Usage="Required">
                <L7p:ComparisonAssertion>
                    <L7p:CaseSensitive booleanValue="false"/>
                    <L7p:Expression1 stringValue="${request.http.parameter.format}"/>
                    <L7p:Expression2 stringValue="long"/>
                    <L7p:Predicates predicates="included">
                        <L7p:item binary="included">
                            <L7p:CaseSensitive booleanValue="false"/>
                            <L7p:RightValue stringValue="long"/>
                        </L7p:item>
                    </L7p:Predicates>
                </L7p:ComparisonAssertion>
                <L7p:SetVariable>
                    <L7p:Base64Expression stringValue="U0hPUlQ="/>
                    <L7p:VariableToSet stringValue="format"/>
                </L7p:SetVariable>
                <L7p:assertionComment>
                    <L7p:Properties mapValue="included">
                        <L7p:entry>
                            <L7p:key stringValue="LEFT.COMMENT"/>
                            <L7p:value stringValue="&lt;SHORT or LONG>"/>
                        </L7p:entry>
                    </L7p:Properties>
                </L7p:assertionComment>
            </wsp:OneOrMore>
            <wsp:OneOrMore wsp:Usage="Required">
                <wsp:All wsp:Usage="Required">
                    <L7p:ComparisonAssertion>
                        <L7p:CaseSensitive booleanValue="false"/>
                        <L7p:Expression1 stringValue="${gateway.useStubs}"/>
                        <L7p:Expression2 stringValue="TRUE"/>
                        <L7p:Predicates predicates="included">
                            <L7p:item binary="included">
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:RightValue stringValue="TRUE"/>
                            </L7p:item>
                        </L7p:Predicates>
                    </L7p:ComparisonAssertion>
                    <L7p:Encapsulated>
                        <L7p:EncapsulatedAssertionConfigGuid stringValue="2e6fb6b6-53b8-4aa9-b576-d591cfca143c"/>
                        <L7p:EncapsulatedAssertionConfigName stringValue="createAuditLogEntry"/>
                        <L7p:Parameters mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="Log.dev"/>
                                <L7p:value stringValue="STUB MODE ENABLED: ALL CALLS STUBBED"/>
                            </L7p:entry>
                            <L7p:entry>
                                <L7p:key stringValue="Log.prod"/>
                                <L7p:value stringValue=""/>
                            </L7p:entry>
                        </L7p:Parameters>
                    </L7p:Encapsulated>
                    <L7p:SetVariable>
                        <L7p:Base64Expression stringValue="aHR0cDovLzEyNy4wLjAuMTo4MDgwL3N0dWIvaXB0b0dlbw=="/>
                        <L7p:VariableToSet stringValue="ip.url"/>
                    </L7p:SetVariable>
                    <L7p:SetVariable>
                        <L7p:Base64Expression stringValue="aHR0cDovLzEyNy4wLjAuMTo4MDgwL3N0dWIvd2VhdGhlcg=="/>
                        <L7p:VariableToSet stringValue="weather.url"/>
                    </L7p:SetVariable>
                    <L7p:SetVariable>
                        <L7p:Base64Expression stringValue="aHR0cDovLzEyNy4wLjAuMTo4MDgwL3N0dWIvZ2Vv"/>
                        <L7p:VariableToSet stringValue="geo.url"/>
                    </L7p:SetVariable>
                </wsp:All>
                <wsp:All wsp:Usage="Required">
                    <L7p:ComparisonAssertion>
                        <L7p:CaseSensitive booleanValue="false"/>
                        <L7p:Expression1 stringValue="${gateway.useStubs}"/>
                        <L7p:Expression2 stringValue="TRUE"/>
                        <L7p:Operator operator="NE"/>
                        <L7p:Predicates predicates="included">
                            <L7p:item binary="included">
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:Operator operator="NE"/>
                                <L7p:RightValue stringValue="TRUE"/>
                            </L7p:item>
                        </L7p:Predicates>
                    </L7p:ComparisonAssertion>
                    <L7p:SetVariable>
                        <L7p:Base64Expression stringValue="JHtnYXRld2F5LmlwdG9HZW8udXJsfQ=="/>
                        <L7p:VariableToSet stringValue="ip.url"/>
                    </L7p:SetVariable>
                    <L7p:SetVariable>
                        <L7p:Base64Expression stringValue="JHtnYXRld2F5LndlYXRoZXIudXJsfQ=="/>
                        <L7p:VariableToSet stringValue="weather.url"/>
                    </L7p:SetVariable>
                    <L7p:SetVariable>
                        <L7p:Base64Expression stringValue="JHtnYXRld2F5Lmdlby51cmx9"/>
                        <L7p:VariableToSet stringValue="geo.url"/>
                    </L7p:SetVariable>
                </wsp:All>
                <L7p:assertionComment>
                    <L7p:Properties mapValue="included">
                        <L7p:entry>
                            <L7p:key stringValue="LEFT.COMMENT"/>
                            <L7p:value stringValue="&lt;STUB SUPPORT>"/>
                        </L7p:entry>
                    </L7p:Properties>
                </L7p:assertionComment>
            </wsp:OneOrMore>
            <L7p:Encapsulated>
                <L7p:EncapsulatedAssertionConfigGuid stringValue="2e6fb6b6-53b8-4aa9-b576-d591cfca143c"/>
                <L7p:EncapsulatedAssertionConfigName stringValue="createAuditLogEntry"/>
                <L7p:Parameters mapValue="included">
                    <L7p:entry>
                        <L7p:key stringValue="Log.dev"/>
                        <L7p:value stringValue="ip.url: ${ip.url}, weather.url: ${weather.url}, geo.url: ${geo.url}"/>
                    </L7p:entry>
                    <L7p:entry>
                        <L7p:key stringValue="Log.prod"/>
                        <L7p:value stringValue=""/>
                    </L7p:entry>
                </L7p:Parameters>
            </L7p:Encapsulated>
            <wsp:OneOrMore wsp:Usage="Required">
                <L7p:ComparisonAssertion>
                    <L7p:CaseSensitive booleanValue="false"/>
                    <L7p:Expression1 stringValue="${ipAddress}"/>
                    <L7p:Expression2 stringValue=""/>
                    <L7p:Operator operator="EMPTY"/>
                    <L7p:Predicates predicates="included">
                        <L7p:item binary="included">
                            <L7p:CaseSensitive booleanValue="false"/>
                            <L7p:Operator operator="EMPTY"/>
                            <L7p:RightValue stringValue=""/>
                        </L7p:item>
                    </L7p:Predicates>
                </L7p:ComparisonAssertion>
                <wsp:OneOrMore wsp:Usage="Required">
                    <wsp:All wsp:Usage="Required">
                        <L7p:Encapsulated>
                            <L7p:EncapsulatedAssertionConfigGuid stringValue="2e6fb6b6-53b8-4aa9-b576-d591cfca143c"/>
                            <L7p:EncapsulatedAssertionConfigName stringValue="createAuditLogEntry"/>
                            <L7p:Parameters mapValue="included">
                                <L7p:entry>
                                    <L7p:key stringValue="Log.dev"/>
                                    <L7p:value stringValue="${ip.url}/${ipAddress}"/>
                                </L7p:entry>
                                <L7p:entry>
                                    <L7p:key stringValue="Log.prod"/>
                                    <L7p:value stringValue=""/>
                                </L7p:entry>
                            </L7p:Parameters>
                        </L7p:Encapsulated>
                        <L7p:HttpRoutingAssertion>
                            <L7p:ProtectedServiceUrl stringValue="${ip.url}/${ipAddress}"/>
                            <L7p:ProxyPassword stringValueNull="null"/>
                            <L7p:ProxyUsername stringValueNull="null"/>
                            <L7p:RequestHeaderRules httpPassthroughRuleSet="included">
                                <L7p:ForwardAll booleanValue="true"/>
                                <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Cookie"/>
                                    </L7p:item>
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="SOAPAction"/>
                                    </L7p:item>
                                </L7p:Rules>
                            </L7p:RequestHeaderRules>
                            <L7p:RequestParamRules httpPassthroughRuleSet="included">
                                <L7p:ForwardAll booleanValue="true"/>
                                <L7p:Rules httpPassthroughRules="included"/>
                            </L7p:RequestParamRules>
                            <L7p:ResponseHeaderRules httpPassthroughRuleSet="included">
                                <L7p:ForwardAll booleanValue="true"/>
                                <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Set-Cookie"/>
                                    </L7p:item>
                                </L7p:Rules>
                            </L7p:ResponseHeaderRules>
                            <L7p:ResponseMsgDest stringValue="ipResponse"/>
                            <L7p:SamlAssertionVersion intValue="2"/>
                        </L7p:HttpRoutingAssertion>
                        <L7p:Encapsulated>
                            <L7p:EncapsulatedAssertionConfigGuid stringValue="2e6fb6b6-53b8-4aa9-b576-d591cfca143c"/>
                            <L7p:EncapsulatedAssertionConfigName stringValue="createAuditLogEntry"/>
                            <L7p:Parameters mapValue="included">
                                <L7p:entry>
                                    <L7p:key stringValue="Log.dev"/>
                                    <L7p:value stringValue="IpToGeo Response: ${ipResponse.mainpart}"/>
                                </L7p:entry>
                                <L7p:entry>
                                    <L7p:key stringValue="Log.prod"/>
                                    <L7p:value stringValue=""/>
                                </L7p:entry>
                            </L7p:Parameters>
                        </L7p:Encapsulated>
                        <L7p:EvaluateJsonPathExpression>
                            <L7p:Expression stringValue="$.lat"/>
                            <L7p:OtherTargetMessageVariable stringValue="ipResponse"/>
                            <L7p:Target target="OTHER"/>
                            <L7p:VariablePrefix stringValue="latitude"/>
                        </L7p:EvaluateJsonPathExpression>
                        <L7p:EvaluateJsonPathExpression>
                            <L7p:Expression stringValue="$.lon"/>
                            <L7p:OtherTargetMessageVariable stringValue="ipResponse"/>
                            <L7p:Target target="OTHER"/>
                            <L7p:VariablePrefix stringValue="longitude"/>
                        </L7p:EvaluateJsonPathExpression>
                        <L7p:Encapsulated>
                            <L7p:EncapsulatedAssertionConfigGuid stringValue="2e6fb6b6-53b8-4aa9-b576-d591cfca143c"/>
                            <L7p:EncapsulatedAssertionConfigName stringValue="createAuditLogEntry"/>
                            <L7p:Parameters mapValue="included">
                                <L7p:entry>
                                    <L7p:key stringValue="Log.dev"/>
                                    <L7p:value stringValue="IpToGeo: Pulled out latitude: ${latitude.result}, longitude: ${longitude.result}"/>
                                </L7p:entry>
                                <L7p:entry>
                                    <L7p:key stringValue="Log.prod"/>
                                    <L7p:value stringValue=""/>
                                </L7p:entry>
                            </L7p:Parameters>
                        </L7p:Encapsulated>
                        <L7p:SetVariable>
                            <L7p:Base64Expression stringValue="JHtsYXRpdHVkZS5yZXN1bHR9LCR7bG9uZ2l0dWRlLnJlc3VsdH0="/>
                            <L7p:VariableToSet stringValue="coordinates"/>
                        </L7p:SetVariable>
                        <L7p:assertionComment>
                            <L7p:Properties mapValue="included">
                                <L7p:entry>
                                    <L7p:key stringValue="LEFT.COMMENT"/>
                                    <L7p:value stringValue="&lt;CALL>"/>
                                </L7p:entry>
                            </L7p:Properties>
                        </L7p:assertionComment>
                    </wsp:All>
                    <wsp:OneOrMore wsp:Usage="Required">
                        <L7p:SetVariable>
                            <L7p:Base64Expression stringValue="QmFja2VuZCBTeXN0ZW0gRXJyb3I="/>
                            <L7p:VariableToSet stringValue="error"/>
                        </L7p:SetVariable>
                        <L7p:Encapsulated>
                            <L7p:EncapsulatedAssertionConfigGuid stringValue="2e6fb6b6-53b8-4aa9-b576-d591cfca143c"/>
                            <L7p:EncapsulatedAssertionConfigName stringValue="createAuditLogEntry"/>
                            <L7p:Parameters mapValue="included">
                                <L7p:entry>
                                    <L7p:key stringValue="Log.dev"/>
                                    <L7p:value stringValue="Call to ip to geo failed: response: "/>
                                </L7p:entry>
                                <L7p:entry>
                                    <L7p:key stringValue="Log.prod"/>
                                    <L7p:value stringValue="Call to ip to geo failed"/>
                                </L7p:entry>
                            </L7p:Parameters>
                        </L7p:Encapsulated>
                        <L7p:FalseAssertion/>
                        <L7p:assertionComment>
                            <L7p:Properties mapValue="included">
                                <L7p:entry>
                                    <L7p:key stringValue="LEFT.COMMENT"/>
                                    <L7p:value stringValue="&lt;ERROR>"/>
                                </L7p:entry>
                            </L7p:Properties>
                        </L7p:assertionComment>
                    </wsp:OneOrMore>
                    <L7p:assertionComment>
                        <L7p:Properties mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="LEFT.COMMENT"/>
                                <L7p:value stringValue="&lt;CALL IP to COORDS>"/>
                            </L7p:entry>
                        </L7p:Properties>
                    </L7p:assertionComment>
                </wsp:OneOrMore>
                <L7p:assertionComment>
                    <L7p:Properties mapValue="included">
                        <L7p:entry>
                            <L7p:key stringValue="LEFT.COMMENT"/>
                            <L7p:value stringValue="&lt;OPTIONAL IP CALL>"/>
                        </L7p:entry>
                    </L7p:Properties>
                </L7p:assertionComment>
            </wsp:OneOrMore>
            <wsp:OneOrMore wsp:Usage="Required">
                <wsp:All wsp:Usage="Required">
                    <L7p:Split>
                        <L7p:InputVariable stringValue="coordinates"/>
                        <L7p:OutputVariable stringValue="coords"/>
                    </L7p:Split>
                    <L7p:Encapsulated>
                        <L7p:EncapsulatedAssertionConfigGuid stringValue="2e6fb6b6-53b8-4aa9-b576-d591cfca143c"/>
                        <L7p:EncapsulatedAssertionConfigName stringValue="createAuditLogEntry"/>
                        <L7p:Parameters mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="Log.dev"/>
                                <L7p:value stringValue="No IP. So split incoming coords into: ${coords[0]} and ${coords[1]}"/>
                            </L7p:entry>
                            <L7p:entry>
                                <L7p:key stringValue="Log.prod"/>
                                <L7p:value stringValue=""/>
                            </L7p:entry>
                        </L7p:Parameters>
                    </L7p:Encapsulated>
                    <L7p:HttpRoutingAssertion>
                        <L7p:ProtectedServiceUrl stringValue="${weather.url}?lat=${coords[0]}&amp;lon=${coords[1]}&amp;mode=xml&amp;APPID=8c2d23e33fb1e176e448bd726de1d094"/>
                        <L7p:ProxyPassword stringValueNull="null"/>
                        <L7p:ProxyUsername stringValueNull="null"/>
                        <L7p:RequestHeaderRules httpPassthroughRuleSet="included">
                            <L7p:ForwardAll booleanValue="true"/>
                            <L7p:Rules httpPassthroughRules="included">
                                <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Cookie"/>
                                </L7p:item>
                                <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="SOAPAction"/>
                                </L7p:item>
                            </L7p:Rules>
                        </L7p:RequestHeaderRules>
                        <L7p:RequestParamRules httpPassthroughRuleSet="included">
                            <L7p:ForwardAll booleanValue="true"/>
                            <L7p:Rules httpPassthroughRules="included"/>
                        </L7p:RequestParamRules>
                        <L7p:ResponseHeaderRules httpPassthroughRuleSet="included">
                            <L7p:ForwardAll booleanValue="true"/>
                            <L7p:Rules httpPassthroughRules="included">
                                <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Set-Cookie"/>
                                </L7p:item>
                            </L7p:Rules>
                        </L7p:ResponseHeaderRules>
                        <L7p:ResponseMsgDest stringValue="weatherResponse"/>
                        <L7p:SamlAssertionVersion intValue="2"/>
                    </L7p:HttpRoutingAssertion>
                    <L7p:Encapsulated>
                        <L7p:EncapsulatedAssertionConfigGuid stringValue="2e6fb6b6-53b8-4aa9-b576-d591cfca143c"/>
                        <L7p:EncapsulatedAssertionConfigName stringValue="createAuditLogEntry"/>
                        <L7p:Parameters mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="Log.dev"/>
                                <L7p:value stringValue="Weather Response: ${weatherResponse.mainpart}"/>
                            </L7p:entry>
                            <L7p:entry>
                                <L7p:key stringValue="Log.prod"/>
                                <L7p:value stringValue=""/>
                            </L7p:entry>
                        </L7p:Parameters>
                    </L7p:Encapsulated>
                    <L7p:assertionComment>
                        <L7p:Properties mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="LEFT.COMMENT"/>
                                <L7p:value stringValue="&lt;WEATHER>"/>
                            </L7p:entry>
                        </L7p:Properties>
                    </L7p:assertionComment>
                </wsp:All>
                <wsp:OneOrMore wsp:Usage="Required">
                    <L7p:SetVariable>
                        <L7p:Base64Expression stringValue="QmFja2VuZCBTeXN0ZW0gRXJyb3I="/>
                        <L7p:VariableToSet stringValue="error"/>
                    </L7p:SetVariable>
                    <L7p:Encapsulated>
                        <L7p:EncapsulatedAssertionConfigGuid stringValue="2e6fb6b6-53b8-4aa9-b576-d591cfca143c"/>
                        <L7p:EncapsulatedAssertionConfigName stringValue="createAuditLogEntry"/>
                        <L7p:Parameters mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="Log.dev"/>
                                <L7p:value stringValue="Call to weather failed"/>
                            </L7p:entry>
                            <L7p:entry>
                                <L7p:key stringValue="Log.prod"/>
                                <L7p:value stringValue="Call to weather failed"/>
                            </L7p:entry>
                        </L7p:Parameters>
                    </L7p:Encapsulated>
                    <L7p:FalseAssertion/>
                    <L7p:assertionComment>
                        <L7p:Properties mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="LEFT.COMMENT"/>
                                <L7p:value stringValue="&lt;ERROR>"/>
                            </L7p:entry>
                        </L7p:Properties>
                    </L7p:assertionComment>
                </wsp:OneOrMore>
                <L7p:assertionComment>
                    <L7p:Properties mapValue="included">
                        <L7p:entry>
                            <L7p:key stringValue="LEFT.COMMENT"/>
                            <L7p:value stringValue="&lt;CALL WEATHER>"/>
                        </L7p:entry>
                    </L7p:Properties>
                </L7p:assertionComment>
            </wsp:OneOrMore>
            <wsp:OneOrMore wsp:Usage="Required">
                <wsp:All wsp:Usage="Required">
                    <L7p:HttpRoutingAssertion>
                        <L7p:ProtectedServiceUrl stringValue="${geo.url}?key=${gateway.geo.key}&amp;latlng=${coordinates}&amp;sensor=true"/>
                        <L7p:ProxyPassword stringValueNull="null"/>
                        <L7p:ProxyUsername stringValueNull="null"/>
                        <L7p:RequestHeaderRules httpPassthroughRuleSet="included">
                            <L7p:ForwardAll booleanValue="true"/>
                            <L7p:Rules httpPassthroughRules="included">
                                <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Cookie"/>
                                </L7p:item>
                                <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="SOAPAction"/>
                                </L7p:item>
                            </L7p:Rules>
                        </L7p:RequestHeaderRules>
                        <L7p:RequestParamRules httpPassthroughRuleSet="included">
                            <L7p:ForwardAll booleanValue="true"/>
                            <L7p:Rules httpPassthroughRules="included"/>
                        </L7p:RequestParamRules>
                        <L7p:ResponseHeaderRules httpPassthroughRuleSet="included">
                            <L7p:ForwardAll booleanValue="true"/>
                            <L7p:Rules httpPassthroughRules="included">
                                <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Set-Cookie"/>
                                </L7p:item>
                            </L7p:Rules>
                        </L7p:ResponseHeaderRules>
                        <L7p:ResponseMsgDest stringValue="geoResponse"/>
                        <L7p:SamlAssertionVersion intValue="2"/>
                    </L7p:HttpRoutingAssertion>
                    <L7p:Encapsulated>
                        <L7p:EncapsulatedAssertionConfigGuid stringValue="2e6fb6b6-53b8-4aa9-b576-d591cfca143c"/>
                        <L7p:EncapsulatedAssertionConfigName stringValue="createAuditLogEntry"/>
                        <L7p:Parameters mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="Log.dev"/>
                                <L7p:value stringValue="geoResponse: ${geoResponse.mainpart}"/>
                            </L7p:entry>
                            <L7p:entry>
                                <L7p:key stringValue="Log.prod"/>
                                <L7p:value stringValue=""/>
                            </L7p:entry>
                        </L7p:Parameters>
                    </L7p:Encapsulated>
                    <L7p:assertionComment>
                        <L7p:Properties mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="LEFT.COMMENT"/>
                                <L7p:value stringValue="&lt;CALL>"/>
                            </L7p:entry>
                        </L7p:Properties>
                    </L7p:assertionComment>
                </wsp:All>
                <wsp:OneOrMore wsp:Usage="Required">
                    <L7p:SetVariable>
                        <L7p:Base64Expression stringValue="QmFja2VuZCBTeXN0ZW0gRXJyb3I="/>
                        <L7p:VariableToSet stringValue="error"/>
                    </L7p:SetVariable>
                    <L7p:Encapsulated>
                        <L7p:EncapsulatedAssertionConfigGuid stringValue="2e6fb6b6-53b8-4aa9-b576-d591cfca143c"/>
                        <L7p:EncapsulatedAssertionConfigName stringValue="createAuditLogEntry"/>
                        <L7p:Parameters mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="Log.dev"/>
                                <L7p:value stringValue="Call to geo failed"/>
                            </L7p:entry>
                            <L7p:entry>
                                <L7p:key stringValue="Log.prod"/>
                                <L7p:value stringValue="Call to geo failed"/>
                            </L7p:entry>
                        </L7p:Parameters>
                    </L7p:Encapsulated>
                    <L7p:FalseAssertion/>
                    <L7p:assertionComment>
                        <L7p:Properties mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="LEFT.COMMENT"/>
                                <L7p:value stringValue="&lt;ERROR>"/>
                            </L7p:entry>
                        </L7p:Properties>
                    </L7p:assertionComment>
                </wsp:OneOrMore>
                <L7p:assertionComment>
                    <L7p:Properties mapValue="included">
                        <L7p:entry>
                            <L7p:key stringValue="LEFT.COMMENT"/>
                            <L7p:value stringValue="&lt;CALL GEO INFO>"/>
                        </L7p:entry>
                    </L7p:Properties>
                </L7p:assertionComment>
            </wsp:OneOrMore>
            <wsp:OneOrMore wsp:Usage="Required">
                <wsp:All wsp:Usage="Required">
                    <L7p:Encapsulated>
                        <L7p:EncapsulatedAssertionConfigGuid stringValue="2e6fb6b6-53b8-4aa9-b576-d591cfca143c"/>
                        <L7p:EncapsulatedAssertionConfigName stringValue="createAuditLogEntry"/>
                        <L7p:Parameters mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="Log.dev"/>
                                <L7p:value stringValue="creating Response"/>
                            </L7p:entry>
                            <L7p:entry>
                                <L7p:key stringValue="Log.prod"/>
                                <L7p:value stringValue=""/>
                            </L7p:entry>
                        </L7p:Parameters>
                    </L7p:Encapsulated>
                    <L7p:ResponseXpathAssertion>
                        <L7p:VariablePrefix stringValue="formattedAddress"/>
                        <L7p:XmlMsgSrc stringValue="geoResponse"/>
                        <L7p:XpathExpression xpathExpressionValue="included">
                            <L7p:Expression stringValue="/GeocodeResponse/result/formatted_address"/>
                            <L7p:Namespaces mapValue="included">
                                <L7p:entry>
                                    <L7p:key stringValue="s"/>
                                    <L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/>
                                </L7p:entry>
                            </L7p:Namespaces>
                            <L7p:XpathVersion xpathVersion="XPATH_1_0"/>
                        </L7p:XpathExpression>
                    </L7p:ResponseXpathAssertion>
                    <L7p:SetVariable>
                        <L7p:Base64Expression stringValue="JHtmb3JtYXR0ZWRBZGRyZXNzLnJlc3VsdH0="/>
                        <L7p:VariableToSet stringValue="address"/>
                    </L7p:SetVariable>
                    <wsp:OneOrMore wsp:Usage="Required">
                        <wsp:All wsp:Usage="Required">
                            <L7p:ComparisonAssertion>
                                <L7p:Expression1 stringValue="${format}"/>
                                <L7p:Expression2 stringValue="SHORT"/>
                                <L7p:Predicates predicates="included">
                                    <L7p:item binary="included">
                                    <L7p:RightValue stringValue="SHORT"/>
                                    </L7p:item>
                                </L7p:Predicates>
                            </L7p:ComparisonAssertion>
                            <L7p:ResponseXpathAssertion>
                                <L7p:VariablePrefix stringValue="temp"/>
                                <L7p:XmlMsgSrc stringValue="weatherResponse"/>
                                <L7p:XpathExpression xpathExpressionValue="included">
                                    <L7p:Expression stringValue="/current/temperature/@value"/>
                                    <L7p:Namespaces mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="s"/>
                                    <L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/>
                                    </L7p:entry>
                                    </L7p:Namespaces>
                                    <L7p:XpathVersion xpathVersion="XPATH_1_0"/>
                                </L7p:XpathExpression>
                            </L7p:ResponseXpathAssertion>
                            <L7p:XslTransformation>
                                <L7p:Direction intValue="-1"/>
                                <L7p:OtherTargetMessageVariable stringValue="weatherResponse"/>
                                <L7p:ResourceInfo staticResourceInfo="included">
                                    <L7p:Document stringValueReference="inline"><![CDATA[<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
            <xsl:param name="address"/>
                    <xsl:param name="temp.result"/>
    <xsl:template match="/">
    <weather>
    <temp>${temp.result}</temp>
        <address>${address}</address>
            </weather>
    </xsl:template>
</xsl:stylesheet>]]></L7p:Document>
                                </L7p:ResourceInfo>
                                <L7p:Target target="OTHER"/>
                                <L7p:TransformName stringValue=""/>
                                <L7p:XsltVersion stringValue="2.0"/>
                            </L7p:XslTransformation>
                            <L7p:assertionComment>
                                <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="LEFT.COMMENT"/>
                                    <L7p:value stringValue="&lt;SHORT>"/>
                                    </L7p:entry>
                                </L7p:Properties>
                            </L7p:assertionComment>
                        </wsp:All>
                        <wsp:All wsp:Usage="Required">
                            <L7p:ComparisonAssertion>
                                <L7p:Expression1 stringValue="${format}"/>
                                <L7p:Expression2 stringValue="LONG"/>
                                <L7p:Predicates predicates="included">
                                    <L7p:item binary="included">
                                    <L7p:RightValue stringValue="LONG"/>
                                    </L7p:item>
                                </L7p:Predicates>
                            </L7p:ComparisonAssertion>
                            <L7p:XslTransformation>
                                <L7p:Direction intValue="-1"/>
                                <L7p:OtherTargetMessageVariable stringValue="weatherResponse"/>
                                <L7p:ResourceInfo staticResourceInfo="included">
                                    <L7p:Document stringValueReference="inline"><![CDATA[<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <!-- Identity transform -->
        <xsl:param name="address"/>
    <xsl:template match="@*|*|processing-instruction()|comment()">
        <xsl:copy>
            <xsl:apply-templates select="*|@*|text()|processing-instruction()|comment()"/>
        </xsl:copy>
    </xsl:template>
    <xsl:template match="city">
        <address>${address}</address>
    </xsl:template>
</xsl:stylesheet>]]></L7p:Document>
                                </L7p:ResourceInfo>
                                <L7p:Target target="OTHER"/>
                                <L7p:TransformName stringValue=""/>
                                <L7p:XsltVersion stringValue="2.0"/>
                            </L7p:XslTransformation>
                            <L7p:assertionComment>
                                <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="LEFT.COMMENT"/>
                                    <L7p:value stringValue="&lt;LONG>"/>
                                    </L7p:entry>
                                </L7p:Properties>
                            </L7p:assertionComment>
                        </wsp:All>
                        <L7p:assertionComment>
                            <L7p:Properties mapValue="included">
                                <L7p:entry>
                                    <L7p:key stringValue="LEFT.COMMENT"/>
                                    <L7p:value stringValue="&lt;SHORT OR LONG>"/>
                                </L7p:entry>
                            </L7p:Properties>
                        </L7p:assertionComment>
                    </wsp:OneOrMore>
                    <L7p:Encapsulated>
                        <L7p:EncapsulatedAssertionConfigGuid stringValue="2e6fb6b6-53b8-4aa9-b576-d591cfca143c"/>
                        <L7p:EncapsulatedAssertionConfigName stringValue="createAuditLogEntry"/>
                        <L7p:Parameters mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="Log.dev"/>
                                <L7p:value stringValue="Transformed message to : ${weatherResponse.mainpart}. xpath resoved to : ${address}"/>
                            </L7p:entry>
                            <L7p:entry>
                                <L7p:key stringValue="Log.prod"/>
                                <L7p:value stringValue=""/>
                            </L7p:entry>
                        </L7p:Parameters>
                    </L7p:Encapsulated>
                    <L7p:assertionComment>
                        <L7p:Properties mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="LEFT.COMMENT"/>
                                <L7p:value stringValue="&lt;CREATE RESPONSE>"/>
                            </L7p:entry>
                        </L7p:Properties>
                    </L7p:assertionComment>
                </wsp:All>
                <wsp:All wsp:Usage="Required">
                    <L7p:SetVariable>
                        <L7p:Base64Expression stringValue="QmFja2VuZCBTeXN0ZW0gRXJyb3I="/>
                        <L7p:VariableToSet stringValue="error"/>
                    </L7p:SetVariable>
                    <L7p:Encapsulated>
                        <L7p:EncapsulatedAssertionConfigGuid stringValue="2e6fb6b6-53b8-4aa9-b576-d591cfca143c"/>
                        <L7p:EncapsulatedAssertionConfigName stringValue="createAuditLogEntry"/>
                        <L7p:Parameters mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="Log.dev"/>
                                <L7p:value stringValue="create response failed"/>
                            </L7p:entry>
                            <L7p:entry>
                                <L7p:key stringValue="Log.prod"/>
                                <L7p:value stringValue="create response failed"/>
                            </L7p:entry>
                        </L7p:Parameters>
                    </L7p:Encapsulated>
                    <L7p:FalseAssertion/>
                    <L7p:assertionComment>
                        <L7p:Properties mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="LEFT.COMMENT"/>
                                <L7p:value stringValue="&lt;ERROR>"/>
                            </L7p:entry>
                        </L7p:Properties>
                    </L7p:assertionComment>
                </wsp:All>
                <L7p:assertionComment>
                    <L7p:Properties mapValue="included">
                        <L7p:entry>
                            <L7p:key stringValue="LEFT.COMMENT"/>
                            <L7p:value stringValue="&lt;CREATE RESPONSE>"/>
                        </L7p:entry>
                    </L7p:Properties>
                </L7p:assertionComment>
            </wsp:OneOrMore>
            <wsp:OneOrMore wsp:Usage="Required">
                <wsp:All wsp:Usage="Required">
                    <L7p:ComparisonAssertion>
                        <L7p:CaseSensitive booleanValue="false"/>
                        <L7p:Expression1 stringValue="${request.http.header.accept-encoding}"/>
                        <L7p:MultivaluedComparison multivaluedComparison="ANY"/>
                        <L7p:Operator operatorNull="null"/>
                        <L7p:Predicates predicates="included">
                            <L7p:item dataType="included">
                                <L7p:Type variableDataType="string"/>
                            </L7p:item>
                            <L7p:item binary="included">
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:Operator operator="CONTAINS"/>
                                <L7p:RightValue stringValue="json"/>
                            </L7p:item>
                        </L7p:Predicates>
                    </L7p:ComparisonAssertion>
                    <L7p:JsonTransformation>
                        <L7p:DestinationMessageTarget MessageTarget="included">
                            <L7p:OtherTargetMessageVariable stringValue="weatherResponse"/>
                            <L7p:Target target="OTHER"/>
                            <L7p:TargetModifiedByGateway booleanValue="true"/>
                        </L7p:DestinationMessageTarget>
                        <L7p:OtherTargetMessageVariable stringValue="weatherResponse"/>
                        <L7p:PrettyPrint booleanValue="true"/>
                        <L7p:RootTagString stringValue=""/>
                        <L7p:Target target="OTHER"/>
                    </L7p:JsonTransformation>
                    <L7p:Encapsulated>
                        <L7p:EncapsulatedAssertionConfigGuid stringValue="2e6fb6b6-53b8-4aa9-b576-d591cfca143c"/>
                        <L7p:EncapsulatedAssertionConfigName stringValue="createAuditLogEntry"/>
                        <L7p:Parameters mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="Log.dev"/>
                                <L7p:value stringValue="Returning JSON Formatted Response: ${weatherResponse.mainpart}"/>
                            </L7p:entry>
                            <L7p:entry>
                                <L7p:key stringValue="Log.prod"/>
                                <L7p:value stringValue=""/>
                            </L7p:entry>
                        </L7p:Parameters>
                    </L7p:Encapsulated>
                    <L7p:HardcodedResponse>
                        <L7p:Base64ResponseBody stringValue="JHt3ZWF0aGVyUmVzcG9uc2V9"/>
                        <L7p:ResponseContentType stringValue="application/json; charset=UTF-8"/>
                    </L7p:HardcodedResponse>
                    <L7p:assertionComment>
                        <L7p:Properties mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="LEFT.COMMENT"/>
                                <L7p:value stringValue="&lt;JSON>"/>
                            </L7p:entry>
                        </L7p:Properties>
                    </L7p:assertionComment>
                </wsp:All>
                <wsp:All wsp:Usage="Required">
                    <L7p:ComparisonAssertion>
                        <L7p:CaseSensitive booleanValue="false"/>
                        <L7p:Enabled booleanValue="false"/>
                        <L7p:Expression1 stringValue="${request.http.header.accept-encoding}"/>
                        <L7p:Expression2 stringValue="application/xml"/>
                        <L7p:MultivaluedComparison multivaluedComparison="ANY"/>
                        <L7p:Predicates predicates="included">
                            <L7p:item binary="included">
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:RightValue stringValue="application/xml"/>
                            </L7p:item>
                        </L7p:Predicates>
                    </L7p:ComparisonAssertion>
                    <L7p:Encapsulated>
                        <L7p:EncapsulatedAssertionConfigGuid stringValue="2e6fb6b6-53b8-4aa9-b576-d591cfca143c"/>
                        <L7p:EncapsulatedAssertionConfigName stringValue="createAuditLogEntry"/>
                        <L7p:Parameters mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="Log.dev"/>
                                <L7p:value stringValue="Returning XML Formatted Response: ${weatherResponse.mainpart}"/>
                            </L7p:entry>
                            <L7p:entry>
                                <L7p:key stringValue="Log.prod"/>
                                <L7p:value stringValue=""/>
                            </L7p:entry>
                        </L7p:Parameters>
                    </L7p:Encapsulated>
                    <L7p:HardcodedResponse>
                        <L7p:Base64ResponseBody stringValue="JHt3ZWF0aGVyUmVzcG9uc2V9"/>
                        <L7p:ResponseContentType stringValue="application/xml; charset=UTF-8"/>
                    </L7p:HardcodedResponse>
                    <L7p:assertionComment>
                        <L7p:Properties mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="LEFT.COMMENT"/>
                                <L7p:value stringValue="&lt;XML>"/>
                            </L7p:entry>
                        </L7p:Properties>
                    </L7p:assertionComment>
                </wsp:All>
                <L7p:assertionComment>
                    <L7p:Properties mapValue="included">
                        <L7p:entry>
                            <L7p:key stringValue="LEFT.COMMENT"/>
                            <L7p:value stringValue="&lt;TRANSFORM RESPONSE>"/>
                        </L7p:entry>
                    </L7p:Properties>
                </L7p:assertionComment>
            </wsp:OneOrMore>
        </wsp:All>
    </wsp:Policy>
</exp:Export>
